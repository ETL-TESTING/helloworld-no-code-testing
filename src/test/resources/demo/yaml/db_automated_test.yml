scenarioName: "DbSqlExecutor: Load a CSV file with headers - PostgreSQL"
steps:
  - name: "test_source_count"
    url: "db://MagicExecutor"
    operation: "EXECUTE"
    request:
      sql: |
        SELECT
            COUNT(*) AS total_customer_records,
            COUNT(DISTINCT id) AS distinct_customer_ids
        FROM stagingrepdb.public.customer;
    verify:
      rows.SIZE: 1
      rows:
        - total_customer_records: 2
          distinct_customer_ids: 2
